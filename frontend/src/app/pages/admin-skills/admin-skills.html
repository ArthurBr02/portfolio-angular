<div class="admin-page">
    <app-admin-page-header title="Manage Skills" buttonText="Add New Category" [showForm]="showForm()"
        (buttonClick)="toggleForm()">
    </app-admin-page-header>

    @if (showForm()) {
    <div class="form-card glass-card">
        <h3>Add New Skill Category</h3>
        <form [formGroup]="skillForm" (ngSubmit)="onSubmit()">
            <app-form-input label="Category Name" formControlName="name" [required]="true"
                placeholder="e.g. Frontend Development">
            </app-form-input>

            <app-form-file-input label="Icon Image" accept="image/*" [required]="true"
                (fileSelected)="onIconFileSelected($event)">
            </app-form-file-input>
            @if (selectedIconFile) {
            <small class="form-hint" style="color: #10b981; display: block; margin-top: -1rem; margin-bottom: 1rem;">
                Selected: {{ selectedIconFile.name }}
            </small>
            }

            <app-form-input label="Skills (comma separated)" formControlName="skills" [required]="true"
                placeholder="Angular, React, Vue.js, etc.">
            </app-form-input>

            <button type="submit" class="btn btn-primary" [disabled]="skillForm.invalid || isSubmitting()">
                {{ isSubmitting() ? 'Saving...' : 'Save Category' }}
            </button>
        </form>
    </div>
    }

    <div class="skills-list">
        @for (category of skillCategories(); track category.name) {
        <div class="skill-item glass-card">
            <div class="skill-icon">
                <img [src]="getIconUrl(category.id)" [alt]="category.name + ' icon'">
            </div>
            <div class="skill-info">
                <h4>{{ category.name }}</h4>
                <div class="tech-tags">
                    @for (skill of category.skills; track skill) {
                    <span class="tech-tag">{{ skill }}</span>
                    }
                </div>
            </div>
            <button type="button" class="btn-delete" (click)="deleteCategory(category.id, $event)">üóëÔ∏è</button>
        </div>
        }
    </div>

    <app-delete-confirmation-modal [isOpen]="showDeleteModal()" title="Delete Category"
        message="Are you sure you want to delete this skill category? This action cannot be undone."
        (confirm)="confirmDelete()" (cancel)="closeDeleteModal()">
    </app-delete-confirmation-modal>
</div>